import{r as n,u as k,a as V,j as e,L,b as f}from"./index-BUV-rzur.js";import{u as I,E as q,a as C}from"./index.esm-JYxLvxbe.js";const D=()=>{const{register:i,handleSubmit:y,getValues:c,formState:{errors:F}}=I(),[d,b]=n.useState(!1),[j,t]=n.useState(!1),[w,a]=n.useState(""),[m,N]=n.useState(!1),[v,O]=n.useState(!1),[p,x]=n.useState(!1),[g,h]=n.useState(!1),u=k(),{setUser:S}=V();n.useEffect(()=>{localStorage.getItem("userToken")&&u("/home")},[u]);const P=async r=>{var l;try{const s=await f.post("http://localhost:8080/v1/login",{email:r.email,password:r.password});if(s.data.success){const o=s.data.token;localStorage.setItem("userToken",o),S(s.data.user),u("/home",{replace:!0})}}catch(s){console.error("Login error: ",((l=s.response)==null?void 0:l.data)||s.message),t(!0),a("Invalid Credentials!")}},T=async()=>{var l;const r=c("email");if(!r){a("Please enter your email first."),t(!0);return}x(!0);try{const s=await f.post("http://localhost:8080/v1/get-otp",{email:r});s.data.success?(O(!0),t(!1),a("")):(t(!0),a(s.data.message||"Failed to send OTP."))}catch(s){console.error("Send OTP error:",((l=s.response)==null?void 0:l.data)||s.message),t(!0),a("Error sending OTP.")}finally{x(!1)}},E=async()=>{var s;const r=c("email"),l=c("otp");if(!r||!l){a("Email and OTP are required."),t(!0);return}h(!0);try{console.log("Verifying OTP for email:",r,"with OTP:",l);const o=await f.post("http://localhost:8080/v1/verify-otp",{email:r,otp:l});console.log("OTP verification response:",o.data),o.data.success?(N(!0),t(!1),a("")):(t(!0),a(o.data.message||"OTP verification failed."))}catch(o){console.error("Verify OTP error:",((s=o.response)==null?void 0:s.data)||o.message),t(!0),a("Error verifying OTP.")}finally{h(!1)}};return e.jsx("div",{className:"flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg flex w-full max-w-5xl p-5",children:[e.jsx("div",{className:"hidden md:flex w-1/2 justify-center items-center",children:e.jsx("img",{src:"/illustrations/medicine.svg",alt:"Medicine Illustration",className:"w-full h-auto"})}),e.jsxs("div",{className:"w-full md:w-1/2 p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Welcome Back!"}),e.jsxs("form",{className:"space-y-4",onSubmit:y(P),onChange:()=>{t(!1)},children:[e.jsx("div",{children:e.jsx("input",{type:"email",...i("email",{required:"Email is required"}),placeholder:"Enter your email",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:d?"text":"password",placeholder:"Password",...i("password",{required:"Password is required"}),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-3 flex items-center text-gray-600",onClick:()=>b(!d),children:d?e.jsx(q,{}):e.jsx(C,{})})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center mb-5",children:[e.jsxs("div",{className:"flex justify-center items-center space-x-3 w-full",children:[e.jsx("input",{type:"text",placeholder:"Enter OTP",...i("otp"),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:E,disabled:g,className:"btn-primary",children:m?"Verified":g?"Verifying...":"Verify OTP"})]}),!v&&e.jsx("button",{type:"button",onClick:T,className:"text-blue-600 mt-2",disabled:p,children:p?"Sending...":"Send OTP"})]}),j&&e.jsx("div",{className:"text-red-500 text-sm mt-2",children:w}),e.jsx("button",{className:"btn-primary w-full",type:"submit",disabled:!m,children:"Log in"})]}),e.jsxs("p",{className:"text-center mt-4",children:["Don't have an account? ",e.jsx(L,{to:"/register",className:"text-blue-600",children:"Sign Up"})]}),e.jsxs("div",{className:"flex justify-center items-center space-x-3 mt-4",children:[e.jsx("button",{className:"bg-blue-600 text-white p-2 rounded-full",children:"F"}),e.jsx("button",{className:"bg-blue-400 text-white p-2 rounded-full",children:"T"}),e.jsx("button",{className:"bg-red-500 text-white p-2 rounded-full",children:"G"})]})]})]})})};export{D as default};
